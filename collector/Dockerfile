FROM internal-registry.ghostcloud.cn/venus/ubuntu-jdk8:16.04.1

COPY skywalking-apm-collector /skywalking-apm-collector

WORKDIR /skywalking-apm-collector

# agent/config/agent.config
ENV SW_AGENT_COLLECTOR_BACKEND_SERVICES=192.168.0.151:11800

# config/application.yml
ENV SW_CORE_REST_HOST=0.0.0.0
ENV SW_CORE_REST_PORT=12800
ENV SW_CORE_GRPC_HOST=0.0.0.0
ENV SW_CORE_GRPC_PORT=11800

ENV SW_STORAGE_ES_CLUSTER_NODES=192.168.0.151:9200
ENV SW_STORAGE_ES_INDEX_SHARDS_NUMBER=2
ENV SW_STORAGE_ES_INDEX_REPLICAS_NUMBER=0
ENV SW_STORAGE_ES_BULK_ACTIONS=2000
ENV SW_STORAGE_ES_BULK_SIZE=20
ENV SW_STORAGE_ES_FLUSH_INTERVAL=10
ENV SW_STORAGE_ES_CONCURRENT_REQUESTS=2

EXPOSE 11800 12800

ENTRYPOINT ["sh", "bin/oapService.sh"]